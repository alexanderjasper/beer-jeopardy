$(document).on("click",".navbar-collapse.in",function(e){$(e.target).is("a")&&$(this).collapse("hide")});var connection=null,signalRIsConnected=!1,categoryToDeleteId=null;function MoveAnswerQuestion(position,direction){var thisQuestionId="q".concat(position),thisAnswerId="a".concat(position),targetQuestionId="q".concat("up"===direction?position-1:position+1),targetAnswerId="a".concat("up"===direction?position-1:position+1),thisQuestion=document.getElementById(thisQuestionId),thisQuestionValue=thisQuestion.value,thisAnswer=document.getElementById(thisAnswerId),thisAnswerValue=thisAnswer.value,targetQuestion=document.getElementById(targetQuestionId),targetQuestionValue=targetQuestion.value,targetAnswer=document.getElementById(targetAnswerId),targetAnswerValue=targetAnswer.value;thisQuestion.value=targetQuestionValue,thisAnswer.value=targetAnswerValue,targetQuestion.value=thisQuestionValue,targetAnswer.value=thisAnswerValue}function addSpinner(button){button.classList.add("active")}function removeSpinner(button){button.classList.remove("active")}function checkIfGameChanged(){var gameId="";return $.ajax({url:"/getGameId",async:!1,dataType:"text",success:function(data){gameId=data}}),""===gameId||signalRIsConnected||reconnectWebsocket(gameId),gameId}function reconnectWebsocket(gameId){null!=connection&&connection.stop(),(connection=(new signalR.HubConnectionBuilder).withUrl("/gameUpdate").configureLogging(signalR.LogLevel.Information).build()).on("gameUpdated",function(data){connection.stop(),gameBottomMargin=$("#gameBottomMargin"),gameBottomMargin.length&&gameBottomMargin.length>0&&loadGame()}),connection.onclose(function(){signalRIsConnected=!1,loadGame()}),connection.start().then(function(){connection.invoke("joinGroup",gameId),signalRIsConnected=!0})}function selectAnswerQuestion(elem){var labels=document.getElementsByClassName("category-radio-button-label");for(i=0;i<labels.length;i++)labels[i].classList.remove("selected");elem.classList.add("selected")}$(document).ready(function(){$(document).click(function(event){var clickover=$(event.target),_opened;!0!==$(".navbar-collapse").hasClass("navbar-collapse collapse in")||clickover.hasClass("navbar-toggle")||$("button.navbar-toggle").click()})});var loadRules=function(){$("#master-container").load("/Home/Rules")},loadCategories=function(){$("#master-container").load("/Home/Categories")},loadCategoriesAdded=function(){$("#master-container").load("/Home/Categories?pageAction=AddedCategory")},loadCategoriesEdited=function(){$("#master-container").load("/Home/Categories?pageAction=EditedCategory")},loadCategoriesDeleted=function(){$("#master-container").load("/Home/Categories?pageAction=DeletedCategory")},loadGame=function(){var gameId;""===checkIfGameChanged()?$("#master-container").load("/Home/Main"):$("#master-container").load("/Home/Game")},loadMain=function(){$("#master-container").load("/Home/Main")},loadAddGame=function(){$("#master-container").load("/Game/Add")},loadCreateCategory=function(){$("#master-container").load("/Category/Create")},loadParticipateGame=function(){$("#master-container").load("/Game/Participate")},submitCategory=function(){var name=$("#Name")[0].value,form=$("#categoryForm"),id=$("#Id")[0].value;if(null===name||""==$.trim(name))return showElement("mustNameCategoryWarning"),!1;$.ajax({url:"/Category/SubmitCategory",data:form.serialize(),async:!1}),""===id?loadCategoriesAdded():loadCategoriesEdited()},editCategory=function(categoryId){$.post("/Category/Edit",{chosenCategoryGuid:categoryId}).done(function(data){$("#master-container").html(data)})},deleteCategory=function(categoryId){categoryToDeleteId=categoryId,showElement("deleteCategoryModal")},deleteCategoryConfirm=function(button){addSpinner(button),$.ajax({url:"/Category/Delete",type:"post",data:{chosenCategoryGuid:categoryToDeleteId},async:!1}).done(function(data){data&&(hideElement("deleteCategoryModal"),loadCategoriesDeleted())}),removeSpinner(button)},completeAddGame=function(){var form=$("#addGameForm");validateCompleteAddGame(form)&&($.ajax({url:"/Game/Completeadd",data:form.serialize(),async:!1}),loadGame())},validateCompleteAddGame=function(form){var gameName=form[0][0].value,selectedIndex,categoryMissing=0===form[0][1].selectedIndex;chooseCategoryWarning(categoryMissing);var gameNameMissing=null===gameName||""===gameName;return enterGameNameWarning(gameNameMissing),!categoryMissing&&!gameNameMissing},chooseCategoryWarning=function(shouldShow){var warning=document.getElementById("chooseCategoryWarning");warning.style.display=shouldShow?"block":"none"},enterGameNameWarning=function(shouldShow){var warning=document.getElementById("enterGameNameWarning");warning.style.display=shouldShow?"block":"none"},completeParticipation=function(){var form=$("#completeParticipationForm");validateCompleteParticipation(form)&&($.ajax({url:"/Game/CompleteParticipation",data:form.serialize(),async:!1}),loadGame())},validateCompleteParticipation=function(form){var gameIndex=form[0][0].selectedIndex,categoryIndex=form[0][1].selectedIndex,gameMissing=0===gameIndex;showHideElement("gameMissingWarning",gameMissing);var categoryMissing=0===categoryIndex;return showHideElement("categoryMissingWarning",categoryMissing),!gameMissing&&!categoryMissing},selectWinner=function(winnerId,gameId,button){addSpinner(button),$.ajax({url:"/Game/SelectWinner",type:"post",data:{ChosenWinnerId:winnerId,Game:{Id:gameId}},async:!1}),loadGame()},selectAnswer=function(button,chosenAnswerQuestionId,gameId){null!=button&&addSpinner(button),$.ajax({url:"/Game/SelectAnswer",data:{ChosenAnswerQuestionGuid:chosenAnswerQuestionId,GameId:gameId},async:!1}),loadGame()},eatYourNoteConfirm=function(button){null!=button&&addSpinner(button),$.ajax({url:"/Game/EatYourNote",type:"post",success:function(){hideElement("eatYourNoteModal"),loadGame(),removeSpinner(button)}})},leaveGameConfirm=function(button){null!=button&&addSpinner(button),$.ajax({url:"/Game/LeaveGame",type:"post",success:function(){loadMain(),hideElement("leaveGameModal"),removeSpinner(button)},error:function(){removeSpinner(button),hideElement("leaveGameModal"),showElement("leaveGameError")}})},showElement=function(elementId){element=document.getElementById(elementId),element.style.display="block"},hideElement=function(elementId){element=document.getElementById(elementId),element.style.display="none"},showHideElement=function(elementId,shouldShow){shouldShow?showElement(elementId):hideElement(elementId)};