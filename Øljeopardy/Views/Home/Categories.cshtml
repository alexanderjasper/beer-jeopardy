@model Oljeopardy.Models.JeopardyViewModels.CategoriesViewModel

<h1>@ViewData["Title"]</h1>
<hr />

<div class="row">
    @if ((string)ViewData["Message"] != "")
    {
        <div class="alert alert-success">
            <strong>@ViewData["Message"]</strong>
        </div>
    }
    <div class="row button-container">
        <form><button type="button" onclick="loadCreateCategory()" class="menubutton">Opret kategori</button></form>
    </div>
    <div style="height:20px"></div>
    @if (@Model.CategoryList != null && Model.CategoryList.Count() > 0)
    {
        @foreach (var category in @Model.CategoryList)
        {
            <div class="category-list-item">
                <div class="row vertical-align">
                    <div class="col-xs-12">
                        @(category.Name)
                    </div>
                    @if (!category.Shared)
                    {
                        <a class="a-button pull-right" onclick="shareCategory('@(category.Id)')">
                            <i class="fas fa-share fa-lg" style="margin-right: 20px;"></i>
                        </a>
                    }
                    <a class="a-button" onclick="deleteCategory('@(category.Id)')">
                        <i class="fas fa-trash-alt fa-lg" style="margin-right: 20px;"></i>
                    </a>
                    <a class="a-button pull-right" onclick="editCategory('@(category.Id)')">
                        <i class="fas fa-edit fa-lg"  style="margin-right: 10px;"></i>
                    </a>
                </div>
            </div>
        }
    }
    else
    {
        <h4>
            Du har endnu ikke oprettet en kategori.
        </h4>
    }
    <h2>Gemte kategorier</h2>
    <table id="savedCategories"></table>
    <script>
        $(document).ready(function () {
            $('#savedCategories').dataTable({
                serverSide: true,
                ajax: "/category/SavedCategories",
                lengthChange: false,
                columns: [
                    {
                        data: 'gem',
                        render: function (data, type, full, meta) {
                            var id = full.category.id;
                            return '<a class="a-button" onclick="unsaveCategory(&quot;' + full.category.id + '&quot);"><i class="fas fa-times fa-lg"></i></a>';
                        },
                        sortable: false,
                        searchable: false,
                        width: '5%'
                    },
                    {
                        name: 'kategori',
                        data: 'category.name',
                        title: 'Kategori',
                        sortable: true,
                        searchable: true,
                        width: '65%'
                    },
                    {
                        name: 'oprettetaf',
                        data: 'ownerUserName',
                        title: 'Oprettet af',
                        sortable: true,
                        searchable: true,
                        width: '30%'
                    }
                ],
                language: {
                    url: '//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Danish.json'
                }
            });
        });
    </script>

    <h2>Kategorikatalog</h2>
    <table id="sharedCategories"></table>
    <script>
        $(document).ready(function () {
            $('#sharedCategories').dataTable({
                serverSide: true,
                ajax: "/category/SharedCategories",
                lengthChange: false,
                columns: [
                    {
                        data: 'gem',
                        render: function (data, type, full, meta) {
                            var id = full.category.id;
                            return '<a class="a-button" onclick="saveCategory(&quot;' + full.category.id + '&quot);"><i class="fas fa-save fa-lg"></i></a>';
                        },
                        sortable: false,
                        searchable: false,
                        width: '5%'
                    },
                    {
                        name: 'kategori',
                        data: 'category.name',
                        title: 'Kategori',
                        sortable: true,
                        searchable: true,
                        width: '65%'
                    },
                    {
                        name: 'oprettetaf',
                        data: 'ownerUserName',
                        title: 'Oprettet af',
                        sortable: true,
                        searchable: true,
                        width: '30%'
                    }
                ],
                language: {
                    url: '//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Danish.json'
                }
            });
        });
    </script>

    <div style="height: 30px"></div>
</div>
<script>
        window.setTimeout(function () {
            $(".alert").fadeTo(500, 0).slideUp(500, function () {
                $(this).remove();
            });
        }, 3000);
</script>
